"use strict";(self.webpackChunkjsapi_angular_cli=self.webpackChunkjsapi_angular_cli||[]).push([[7803],{37803:(q,h,e)=>{e.r(h),e.d(h,{default:()=>k});var c=e(15861),a=e(50484),M=e(66476),C=e(34411),v=e(57964),T=e(30352),L=e(3233),D=e(79412),_=e(80543),R=e(1535),U=(e(57678),e(14007),e(62185)),f=e(10141),j=e(7547),u=e(60301),A=e(26894),x=e(40408),B=e(33721),S=e(95060),K=e(29674),W=e(71413),b=e(4257),Z=e(19855),F=e(27426),N=e(80099),J=e(70509),G=e(25836),V=e(29717),z=e(22921),H=e(12522),Q=e(8966),$=e(61793),Y=e(53715),X=e(25740),g=e(45859),w=e(83739),I=e(764);let s=class extends((0,Z.h)((0,H.n)((0,V.M)((0,z.x)((0,W.O)((0,b.Y)((0,N.q)((0,J.I)((0,L.R)((0,G.Q)((0,K.V)((0,F.N)(S.Z))))))))))))){constructor(...r){super(...r),this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.preferredTimeZone=null,this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null}normalizeCtorArgs(r,t){return"string"==typeof r?{url:r,...t}:r}load(r){const t=null!=r?r.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},r).catch(D.r9).then(()=>this._fetchService(t))),Promise.resolve(this)}readImageFormat(r,t){const l=t.supportedImageFormatTypes;return l&&l.includes("PNG32")?"png32":"png24"}writeSublayers(r,t,l,i){if(!this.loaded||!r)return;const p=r.slice().reverse().flatten(({sublayers:n})=>n&&n.toArray().reverse()).toArray();let o=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap?.supportsDynamicLayers){const n=(0,u.M9)(i.origin);if(n===u.s3.PORTAL_ITEM){const d=this.createSublayersForOrigin("service").sublayers;o=(0,g.QV)(p,d,u.s3.SERVICE)}else if(n>u.s3.PORTAL_ITEM){const d=this.createSublayersForOrigin("portal-item");o=(0,g.QV)(p,d.sublayers,(0,u.M9)(d.origin))}}const E=[],y={writeSublayerStructure:o,...i};let m=o;p.forEach(n=>{const d=n.write({},y);E.push(d),m=m||"user"===n.originOf("visible")}),E.some(n=>Object.keys(n).length>1)&&(t.layers=E),m&&(t.visibleLayers=p.filter(n=>n.visible).map(n=>n.id))}createExportImageParameters(r,t,l,i){const p=i?.pixelRatio||1;r&&this.version>=10&&(r=r.clone().shiftCentralMeridian());const o=new $.R({layer:this,floors:i?.floors,scale:(0,x.yZ)({extent:r,width:t})*p}),E=o.toJSON();o.destroy();const y=!i?.rotation||this.version<10.3?{}:{rotation:-i.rotation},m=r?.spatialReference,n=(0,B.B9)(m);E.dpi*=p;const d={};if(i?.timeExtent){const{start:O,end:P}=i.timeExtent.toJSON();d.time=O&&P&&O===P?""+O:`${O??"null"},${P??"null"}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(d.time="null,null");return{bbox:r&&r.xmin+","+r.ymin+","+r.xmax+","+r.ymax,bboxSR:n,imageSR:n,size:t+","+l,...E,...y,...d}}fetchImage(r,t,l,i){var p=this;return(0,c.Z)(function*(){const{data:o}=yield p._fetchImage("image",r,t,l,i);return o})()}fetchImageBitmap(r,t,l,i){var p=this;return(0,c.Z)(function*(){const{data:o,url:E}=yield p._fetchImage("blob",r,t,l,i);return(0,Y.g)(o,E,i?.signal)})()}fetchRecomputedExtents(r={}){var t=this;return(0,c.Z)(function*(){const l={...r,query:{returnUpdates:!0,f:"json",...t.customParameters,token:t.apiKey}},{data:i}=yield(0,M.Z)(t.url,l),{extent:p,fullExtent:o,timeExtent:E}=i,y=p||o;return{fullExtent:y&&A.Z.fromJSON(y),timeExtent:E&&C.Z.fromJSON({start:E[0],end:E[1]})}})()}loadAll(){return(0,T.G)(this,r=>{r(this.allSublayers)})}serviceSupportsSpatialReference(r){return(0,w.D)(this,r)}_fetchImage(r,t,l,i,p){var o=this;return(0,c.Z)(function*(){const E={responseType:r,signal:p?.signal??null,query:{...o.parsedUrl.query,...o.createExportImageParameters(t,l,i,p),f:"image",...o.refreshParameters,...o.customParameters,token:o.apiKey}},y=o.parsedUrl.path+"/export";if(null!=E.query?.dynamicLayers&&!o.capabilities?.exportMap?.supportsDynamicLayers)throw new v.Z("mapimagelayer:dynamiclayer-not-supported",`service ${o.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:E.query});try{const{data:m}=yield(0,M.Z)(y,E);return{data:m,url:y}}catch(m){throw(0,D.D_)(m)?m:new v.Z("mapimagelayer:image-fetch-error",`Unable to load image: ${y}`,{error:m})}})()}_fetchService(r){var t=this;return(0,c.Z)(function*(){if(t.sourceJSON)return void t.read(t.sourceJSON,{origin:"service",url:t.parsedUrl});const{data:l,ssl:i}=yield(0,M.Z)(t.parsedUrl.path,{query:{f:"json",...t.parsedUrl.query,...t.customParameters,token:t.apiKey},signal:r});i&&(t.url=t.url.replace(/^http:/i,"https:")),t.sourceJSON=l,t.read(l,{origin:"service",url:t.parsedUrl})})()}};(0,a._)([(0,_.Cb)((0,I.mi)("dateFieldsTimeReference"))],s.prototype,"dateFieldsTimeZone",void 0),(0,a._)([(0,_.Cb)({type:Boolean})],s.prototype,"datesInUnknownTimezone",void 0),(0,a._)([(0,_.Cb)()],s.prototype,"dpi",void 0),(0,a._)([(0,_.Cb)()],s.prototype,"gdbVersion",void 0),(0,a._)([(0,_.Cb)()],s.prototype,"imageFormat",void 0),(0,a._)([(0,U.r)("imageFormat",["supportedImageFormatTypes"])],s.prototype,"readImageFormat",null),(0,a._)([(0,_.Cb)({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],s.prototype,"imageMaxHeight",void 0),(0,a._)([(0,_.Cb)({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],s.prototype,"imageMaxWidth",void 0),(0,a._)([(0,_.Cb)()],s.prototype,"imageTransparency",void 0),(0,a._)([(0,_.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],s.prototype,"isReference",void 0),(0,a._)([(0,_.Cb)({json:{read:!1,write:!1}})],s.prototype,"labelsVisible",void 0),(0,a._)([(0,_.Cb)({type:["ArcGISMapServiceLayer"]})],s.prototype,"operationalLayerType",void 0),(0,a._)([(0,_.Cb)({json:{read:!1,write:!1}})],s.prototype,"popupEnabled",void 0),(0,a._)([(0,_.Cb)((0,I.mi)("preferredTimeReference"))],s.prototype,"preferredTimeZone",void 0),(0,a._)([(0,_.Cb)()],s.prototype,"sourceJSON",void 0),(0,a._)([(0,_.Cb)({json:{write:{ignoreOrigin:!0}}})],s.prototype,"sublayers",void 0),(0,a._)([(0,j.c)("sublayers",{layers:{type:[X.Z]},visibleLayers:{type:[R.z8]}})],s.prototype,"writeSublayers",null),(0,a._)([(0,_.Cb)({type:["show","hide","hide-children"]})],s.prototype,"listMode",void 0),(0,a._)([(0,_.Cb)({json:{read:!1},readOnly:!0,value:"map-image"})],s.prototype,"type",void 0),(0,a._)([(0,_.Cb)(Q.HQ)],s.prototype,"url",void 0),s=(0,a._)([(0,f.j)("esri.layers.MapImageLayer")],s);const k=s}}]);