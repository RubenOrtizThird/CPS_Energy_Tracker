"use strict";(self.webpackChunkjsapi_angular_cli=self.webpackChunkjsapi_angular_cli||[]).push([[8667],{28667:(z,I,n)=>{n.r(I),n.d(I,{fromUrl:()=>$});var r=n(15861),T=n(57964),t=n(6785),s=n(89713),p=n(63724),O=n(23933),U=n(85971),V=n(79936),S=n(6661);const x={FeatureLayer:!0,SceneLayer:!0};function $(l){return Z.apply(this,arguments)}function Z(){return Z=(0,r.Z)(function*(l){const a=l.properties?.customParameters,e=yield function A(l,a){return D.apply(this,arguments)}(l.url,a),u={...l.properties,url:l.url};if(e.layers.length+e.tables.length===0)return null!=e.layerId&&(u.layerId=e.layerId),null!=e.sourceJSON&&(u.sourceJSON=e.sourceJSON),new e.Constructor(u);const f=new((yield n.e(782).then(n.bind(n,50782))).default)({title:e.parsedUrl.title});return yield function W(l,a,e){return K.apply(this,arguments)}(f,e,u),f}),Z.apply(this,arguments)}function R(l,a){return l?l.find(e=>e.id===a):null}function K(){return(K=(0,r.Z)(function*(l,a,e){function u(o,h,P,g){const L={...e,layerId:h,sublayerTitleMode:"service-name"};return null!=o&&(L.url=o),null!=P&&(L.sourceJSON=P),g(L)}const f=a.sublayerConstructorProvider;for(const{id:o,serverUrl:h}of a.layers){const P=R(a.sublayerInfos,o),g=(P&&f?.(P))??a.Constructor,L=u(h,o,P,d=>new g(d));l.add(L)}if(a.tables.length){const o=yield v("FeatureLayer");a.tables.forEach(({id:h,serverUrl:P})=>{const g=u(P,h,R(a.tableInfos,h),L=>new o(L));l.tables.add(g)})}})).apply(this,arguments)}function D(){return D=(0,r.Z)(function*(l,a){let e=(0,s.Qc)(l);if(null==e&&(e=yield function B(l,a){return F.apply(this,arguments)}(l,a)),null==e)throw new T.Z("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:l});const{serverType:u,sublayer:f}=e;let o;const h={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},P="FeatureServer"===u,g="SceneServer"===u,L={parsedUrl:e,Constructor:null,layerId:P||g?f??void 0:void 0,layers:[],tables:[]};switch(u){case"MapServer":o=null!=f?"FeatureLayer":(yield function J(l,a){return G.apply(this,arguments)}(l,a))?"TileLayer":"MapImageLayer";break;case"ImageServer":{const d=yield(0,S.T)(l,{customParameters:a}),{tileInfo:M,cacheType:j}=d;o=M?"LERC"!==M?.format?.toUpperCase()||j&&"elevation"!==j.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const d=yield(0,S.T)(e.url.path,{customParameters:a});if(o="SceneLayer",d){const M=d?.layers;if("Voxel"===d?.layerType)o="VoxelLayer";else if(M?.length){const j=M[0]?.layerType;null!=j&&null!=U.fb[j]&&(o=U.fb[j])}}break}case"FeatureServer":if(o="FeatureLayer",null!=f){const d=yield(0,S.T)(l,{customParameters:a});L.sourceJSON=d,"Oriented Imagery Layer"===d.type&&(o="OrientedImageryLayer")}break;default:o=h[u]}if(x[o]&&null==f){const d=yield function i(l,a,e){return m.apply(this,arguments)}(l,u,a);if(P&&(L.sublayerInfos=d.layerInfos,L.tableInfos=d.tableInfos),d.layers.length+d.tables.length!==1)L.layers=d.layers,L.tables=d.tables,P&&d.layerInfos?.length&&(L.sublayerConstructorProvider=yield function Q(l){return N.apply(this,arguments)}(d.layerInfos));else if(P||g){const M=d.layerInfos?.[0]??d.tableInfos?.[0];L.layerId=d.layers[0]?.id??d.tables[0]?.id,L.sourceJSON=M,P&&"Oriented Imagery Layer"===M?.type&&(o="OrientedImageryLayer")}}return L.Constructor=yield v(o),L}),D.apply(this,arguments)}function F(){return(F=(0,r.Z)(function*(l,a){const e=yield(0,S.T)(l,{customParameters:a});let u=null,f=null;const o=e.type;if("Feature Layer"===o||"Table"===o?(u="FeatureServer",f=e.id??null):"indexedVector"===o?u="VectorTileServer":e.hasOwnProperty("mapName")?u="MapServer":e.hasOwnProperty("bandCount")&&e.hasOwnProperty("pixelSizeX")?u="ImageServer":e.hasOwnProperty("maxRecordCount")&&e.hasOwnProperty("allowGeometryUpdates")?u="FeatureServer":e.hasOwnProperty("streamUrls")?u="StreamServer":C(e)?(u="SceneServer",f=e.id):e.hasOwnProperty("layers")&&C(e.layers?.[0])&&(u="SceneServer"),!u)return null;const h=null!=f?(0,s.DR)(l):null;return{title:null!=h&&e.name||(0,t.vt)(l),serverType:u,sublayer:f,url:{path:null!=h?h.serviceUrl:(0,t.mN)(l).path}}})).apply(this,arguments)}function C(l){return null!=l&&l.hasOwnProperty("store")&&l.hasOwnProperty("id")&&"number"==typeof l.id}function m(){return m=(0,r.Z)(function*(l,a,e){let u,f,o=!1;switch(a){case"FeatureServer":{const g=yield(0,O.V)(l,{customParameters:e});o=!!g.layersJSON,u=g.layersJSON||g.serviceJSON;break}case"SceneServer":{const g=yield function c(l,a){return y.apply(this,arguments)}(l,e);u=g.serviceInfo,f=g.tableServerUrl;break}default:u=yield(0,S.T)(l,{customParameters:e})}const h=u?.layers,P=u?.tables;return{layers:h?.map(g=>({id:g.id})).reverse()||[],tables:P?.map(g=>({serverUrl:f,id:g.id})).reverse()||[],layerInfos:o?h:[],tableInfos:o?P:[]}}),m.apply(this,arguments)}function y(){return(y=(0,r.Z)(function*(l,a){const e=yield(0,S.T)(l,{customParameters:a});if(!e.layers?.[0])return{serviceInfo:e};try{const{serverUrl:f}=yield(0,p.w)(l),o=yield(0,S.T)(f,{customParameters:a}).catch(()=>null);return o&&(e.tables=o.tables),{serviceInfo:e,tableServerUrl:f}}catch{return{serviceInfo:e}}})).apply(this,arguments)}function v(l){return E.apply(this,arguments)}function E(){return(E=(0,r.Z)(function*(l){return(0,V.T[l])()})).apply(this,arguments)}function G(){return(G=(0,r.Z)(function*(l,a){return(yield(0,S.T)(l,{customParameters:a})).tileInfo})).apply(this,arguments)}function N(){return(N=(0,r.Z)(function*(l){const a=[],e=[];if(l.forEach(o=>{const{type:h}=o;"Oriented Imagery Layer"===h?(a.push(h),e.push(v("OrientedImageryLayer"))):(a.push(h),e.push(v("FeatureLayer")))}),!e.length)return;const u=yield Promise.all(e),f=new Map;return a.forEach((o,h)=>{f.set(o,u[h])}),o=>f.get(o.type)})).apply(this,arguments)}},63724:(z,I,n)=>{n.d(I,{w:()=>S});var r=n(15861),T=n(26152),t=n(66476),s=n(57964),p=n(79412),O=n(89713),U=n(61018),V=n(27835);function S(i,m){return x.apply(this,arguments)}function x(){return x=(0,r.Z)(function*(i,m){const c=(0,O.Qc)(i);if(!c)throw new s.Z("invalid-url","Invalid scene service url");const y={...m,sceneServerUrl:c.url.path,layerId:c.sublayer??void 0};if(y.sceneLayerItem??=(yield function $(i){return Z.apply(this,arguments)}(y)),null==y.sceneLayerItem)return D(y.sceneServerUrl.replace("/SceneServer","/FeatureServer"),y);const v=yield function F(i){return C.apply(this,arguments)}(y);if(!v?.url)throw new s.Z("related-service-not-found","Could not find feature service through portal item relationship");const E=yield D(v.url,y);return E.portalItem=v,E}),x.apply(this,arguments)}function Z(){return Z=(0,r.Z)(function*(i){const m=(yield R(i)).serviceItemId;if(!m)return null;const c=new V.default({id:m,apiKey:i.apiKey}),y=yield function K(i){return A.apply(this,arguments)}(i);null!=y&&(c.portal=new U.Z({url:y}));try{return c.load({signal:i.signal})}catch(v){return(0,p.r9)(v),null}}),Z.apply(this,arguments)}function R(i){return W.apply(this,arguments)}function W(){return(W=(0,r.Z)(function*(i){if(i.rootDocument)return i.rootDocument;const m={query:{f:"json",token:i.apiKey},responseType:"json",signal:i.signal};try{const c=yield(0,t.Z)(i.sceneServerUrl,m);i.rootDocument=c.data}catch{i.rootDocument={}}return i.rootDocument})).apply(this,arguments)}function A(){return(A=(0,r.Z)(function*(i){const m=T.id?.findServerInfo(i.sceneServerUrl);if(m?.owningSystemUrl)return m.owningSystemUrl;const c=i.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const y=(yield(0,t.Z)(c,{query:{f:"json"},responseType:"json",signal:i.signal})).data.owningSystemUrl;if(y)return y}catch(y){(0,p.r9)(y)}return null})).apply(this,arguments)}function D(i,m){return B.apply(this,arguments)}function B(){return(B=(0,r.Z)(function*(i,m){const c=(0,O.Qc)(i);if(!c)throw new s.Z("invalid-feature-service-url","Invalid feature service url");const y=c.url.path,v=m.layerId;if(null==v)return{serverUrl:y};const E=R(m),J=e=>(0,t.Z)(y,{query:{f:"json"},responseType:"json",authMode:e,signal:m.signal}),G=J("anonymous").catch(()=>J("no-prompt")),[Q,N]=yield Promise.all([G,E]),l=N?.layers,a=Q.data&&Q.data.layers;if(!Array.isArray(a))throw new Error("expected layers array");if(Array.isArray(l)){for(let e=0;e<Math.min(l.length,a.length);e++)if(l[e].id===v)return{serverUrl:y,layerId:a[e].id}}else if(null!=v&&v<a.length)return{serverUrl:y,layerId:a[v].id};throw new Error("could not find matching associated sublayer")})).apply(this,arguments)}function C(){return(C=(0,r.Z)(function*({sceneLayerItem:i,signal:m}){if(!i)return null;try{const c=(yield i.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:m})).find(v=>"Feature Service"===v.type)||null;if(!c)return null;const y=new V.default({portal:c.portal,id:c.id});return yield y.load(),y}catch(c){return(0,p.r9)(c),null}})).apply(this,arguments)}},79936:(z,I,n)=>{n.d(I,{T:()=>T});var r=n(15861);const T={BingMapsLayer:(t=(0,r.Z)(function*(){return(yield n.e(4499).then(n.bind(n,84499))).default}),function(){return t.apply(this,arguments)}),BuildingSceneLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8866),n.e(4612),n.e(9893),n.e(9269),n.e(3080)]).then(n.bind(n,23080))).default});return function(){return t.apply(this,arguments)}}(),CSVLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(257).then(n.bind(n,90257))).default});return function(){return t.apply(this,arguments)}}(),DimensionLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(9645)]).then(n.bind(n,59645))).default});return function(){return t.apply(this,arguments)}}(),ElevationLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(1753)]).then(n.bind(n,86069))).default});return function(){return t.apply(this,arguments)}}(),FeatureLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.resolve().then(n.bind(n,90373))).default});return function(){return t.apply(this,arguments)}}(),GeoJSONLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(59).then(n.bind(n,80059))).default});return function(){return t.apply(this,arguments)}}(),GeoRSSLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(9050).then(n.bind(n,39050))).default});return function(){return t.apply(this,arguments)}}(),GroupLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(782).then(n.bind(n,50782))).default});return function(){return t.apply(this,arguments)}}(),ImageryLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(842),n.e(2784),n.e(6062),n.e(3338),n.e(5318),n.e(2861)]).then(n.bind(n,72861))).default});return function(){return t.apply(this,arguments)}}(),ImageryTileLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(6062),n.e(9350),n.e(3338),n.e(3287),n.e(5318),n.e(8592),n.e(8505)]).then(n.bind(n,34208))).default});return function(){return t.apply(this,arguments)}}(),IntegratedMeshLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8866),n.e(8592),n.e(4092)]).then(n.bind(n,74092))).default});return function(){return t.apply(this,arguments)}}(),KMLLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(2858)]).then(n.bind(n,22858))).default});return function(){return t.apply(this,arguments)}}(),LineOfSightLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(6625)]).then(n.bind(n,17551))).default});return function(){return t.apply(this,arguments)}}(),LinkChartLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(842),n.e(3866),n.e(5904),n.e(1518),n.e(6518),n.e(2166),n.e(8592),n.e(9900)]).then(n.bind(n,49900))).default});return function(){return t.apply(this,arguments)}}(),MapImageLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(842),n.e(2784),n.e(9351),n.e(7803)]).then(n.bind(n,37803))).default});return function(){return t.apply(this,arguments)}}(),MapNotesLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(8191)]).then(n.bind(n,18191))).default});return function(){return t.apply(this,arguments)}}(),MediaLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(4313)]).then(n.bind(n,69981))).default});return function(){return t.apply(this,arguments)}}(),OGCFeatureLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(842),n.e(2871),n.e(7960)]).then(n.bind(n,36019))).default});return function(){return t.apply(this,arguments)}}(),OpenStreetMapLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(4930)]).then(n.bind(n,22439))).default});return function(){return t.apply(this,arguments)}}(),OrientedImageryLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(617).then(n.bind(n,60617))).default});return function(){return t.apply(this,arguments)}}(),PointCloudLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8866),n.e(8592),n.e(265)]).then(n.bind(n,70265))).default});return function(){return t.apply(this,arguments)}}(),RouteLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(3301),n.e(5607)]).then(n.bind(n,25607))).default});return function(){return t.apply(this,arguments)}}(),SceneLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8866),n.e(4612),n.e(9893),n.e(9269),n.e(8592),n.e(724)]).then(n.bind(n,20724))).default});return function(){return t.apply(this,arguments)}}(),StreamLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(7157).then(n.bind(n,7157))).default});return function(){return t.apply(this,arguments)}}(),SubtypeGroupLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(6663).then(n.bind(n,46663))).default});return function(){return t.apply(this,arguments)}}(),TileLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(842),n.e(2784),n.e(9351),n.e(8592),n.e(1433)]).then(n.bind(n,77183))).default});return function(){return t.apply(this,arguments)}}(),UnknownLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(4850).then(n.bind(n,84850))).default});return function(){return t.apply(this,arguments)}}(),UnsupportedLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(4680).then(n.bind(n,60842))).default});return function(){return t.apply(this,arguments)}}(),VectorTileLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(7917),n.e(4433),n.e(8592),n.e(8622)]).then(n.bind(n,62003))).default});return function(){return t.apply(this,arguments)}}(),VoxelLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8866),n.e(8592),n.e(4691)]).then(n.bind(n,4691))).default});return function(){return t.apply(this,arguments)}}(),WFSLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(1970),n.e(6562)]).then(n.bind(n,18504))).default});return function(){return t.apply(this,arguments)}}(),WMSLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(616)]).then(n.bind(n,10616))).default});return function(){return t.apply(this,arguments)}}(),WMTSLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(7179)]).then(n.bind(n,67179))).default});return function(){return t.apply(this,arguments)}}(),WebTileLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(3715)]).then(n.bind(n,54556))).default});return function(){return t.apply(this,arguments)}}()};var t},6661:(z,I,n)=>{n.d(I,{T:()=>t});var r=n(15861),T=n(66476);function t(p,O){return s.apply(this,arguments)}function s(){return(s=(0,r.Z)(function*(p,O){const{data:U}=yield(0,T.Z)(p,{responseType:"json",query:{f:"json",...O?.customParameters,token:O?.apiKey}});return U})).apply(this,arguments)}}}]);