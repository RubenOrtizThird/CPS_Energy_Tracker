"use strict";(self.webpackChunkjsapi_angular_cli=self.webpackChunkjsapi_angular_cli||[]).push([[5570],{15570:(A,m,r)=>{r.r(m),r.d(m,{createLabelFunction:()=>L,formatField:()=>h});var O=r(15861),d=r(57964),P=r(4703),M=r(38955),v=r(94678),y=r(37689),j=r(73191),D=r(85295),g=r(56761),U=r(4978);const E=P.Z.getLogger("esri.layers.support.labelFormatUtils"),f={type:"simple",evaluate:()=>null},C={getAttribute:(t,n)=>t.field(n)};function L(t,n,_){return p.apply(this,arguments)}function p(){return(p=(0,O.Z)(function*(t,n,_){if(!t||!t.symbol||!n)return f;const o=t.where,u=(0,g.hV)(t);let a;if("arcade"===u.type){const e=yield(0,U.WW)(u.expression,_,n);if(null==e)return f;a={type:"arcade",evaluate(i,l){try{const s="attributes"in i?e.repurposeFeature(i):i;s.contextTimeZone=l??null;const c=e.evaluate({$view:{timeZone:l},$feature:s},e.services);if(null!=c)return c.toString()}catch(s){E.error(new d.Z("arcade-expression-error","Encountered an error when evaluating label expression for feature",{error:s,feature:i,expression:u}))}return null},needsHydrationToEvaluate:()=>null==(0,g.el)(u.expression)}}else a={type:"simple",evaluate:e=>u.expression.replaceAll(/{[^}]*}/g,i=>{const l=i.slice(1,-1),s=n.get(l);if(!s)return i;let c=null;return"attributes"in e?e&&e.attributes&&(c=e.attributes[s.name]):c=e.field(s.name),null==c?"":h(c,s)})};if(o){let e;try{e=yield(0,M.E)(o,n)}catch(l){return E.error(new d.Z("bad-where-clause","Encountered an error when evaluating where clause, ignoring",{where:o,error:l})),f}const i=a.evaluate;a.evaluate=(l,s)=>{const c="attributes"in l?void 0:C;try{if(e.testFeature(l,c))return i(l,s)}catch(T){E.error(new d.Z("bad-where-clause","Encountered an error when evaluating where clause for feature",{where:o,feature:l,error:T}))}return null}}return a})).apply(this,arguments)}function h(t,n){if(null==t)return"";const _=n.domain;if(_)if("codedValue"===_.type||"coded-value"===_.type){const u=t;for(const a of _.codedValues)if(a.code===u)return a.name}else if("range"===_.type){const{max:u,min:a}=(0,j.D3)(n),e=+t;if(null!=a&&null!=u&&a<=e&&e<=u)return _.name}let o=t;return(0,D.y2)(n)?o=(0,v.p6)(o,(0,v.Ze)("short-date")):(0,D.H7)(n)&&(o=(0,y.uf)(+o)),o||""}}}]);